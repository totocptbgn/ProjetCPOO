<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
<HEAD>
	<TITLE></TITLE>
	<META NAME="GENERATOR" CONTENT="StarOffice/5.0 (Unix)">
	<META NAME="AUTHOR" CONTENT="Roussel gilles">
	<META NAME="CREATED" CONTENT="19990222;9303200">
	<META NAME="CHANGEDBY" CONTENT="Gilles Roussel">
	<META NAME="CHANGED" CONTENT="19990222;9384600">
	<META NAME="Date" CONTENT="Mon Feb 24 1997">
	<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
	<STYLE>
	<!--
	-->
	</STYLE>
</HEAD>
<BODY BGCOLOR="#ffffff">
<H1 ALIGN=CENTER STYLE="margin-top: 0.00cm; margin-bottom: 0.00cm"><FONT COLOR="#ff0000">La
classe <TT>URL</TT></FONT> 
</H1>
<HR>
<H2><FONT COLOR="#3333ff">La classe <TT>URL</TT></FONT></H2>
<P>Cette classe propose une interface de haut niveau pour acc&eacute;der
aux informations du Web en utilisant des <FONT COLOR="#330000"><TT>URL</TT>s</FONT>.

</P>
<P>Pour cr&eacute;er un objet de la classe <TT><FONT COLOR="#330000">URL</FONT></TT>
nous disposons de quatre constructeurs : 
</P>
<UL>
	<LI><TT><FONT COLOR="#330000">public URL(String protocol, String
	machine, int port, String fichier) throws MalformedURLException</FONT></TT>
	<BR>Cr&eacute;e une URL absolue &agrave; partir du protocole, de la
	machine, du port et du fichier. 
	</LI>

 	<LI><TT><FONT COLOR="#330000">public URL(String protocol, String
	machine, String file) throws MalformedURLException</FONT></TT> 
	<BR>Cr&eacute;e une URL absolue &agrave; partir du protocole, de la
	machine et du fichier, en utilisant le port par d&eacute;faut du
	protocole. 
	</LI>

	<LI><TT><FONT COLOR="#330000">public URL(String url) throws
	MalformedURLException</FONT></TT> 
	<BR>Cr&eacute;e une URL absolue &agrave; partir d'une cha&icirc;ne
	de caract&egrave;res brute. 
	</LI>

	<LI><TT><FONT COLOR="#330000">public URL(URL context, String url) throws
	MalformedURLException</FONT></TT> 
	<BR> Cr&eacute;e une URL absolue &agrave;
	partir d'une cha&icirc;ne de caract&egrave;res brute et d'une URL
	contexte. 
	</LI>
</UL>
<P>Exemple : 
</P>
<P>Les trois URLs suivantes repr&eacute;sentent la m&ecirc;me
ressource. <BR><TT><FONT COLOR="#330000">new
URL(&quot;http://massena.univ-mlv.fr/index.html&quot;);</FONT></TT>
<BR><TT><FONT COLOR="#330000">new
URL(&quot;http&quot;,&quot;massena.univ-mlv.fr&quot;,80,&quot;index.html&quot;);</FONT></TT>
<BR><TT><FONT COLOR="#330000">new
URL(&quot;http://massena.univ-mlv.fr/&quot;,&quot;index.html&quot;);</FONT></TT>

</P>
<P>Les m&eacute;thodes suivantes permettent de comparer deux URLs en
incluant ou non l'ancre: <BR><TT><FONT COLOR="#330000">public boolean
sameFile(URL other)</FONT></TT> <BR><TT><FONT COLOR="#330000">public
boolean equals(Object other)</FONT></TT> 
</P>
<P>Pour manipuler les composants de l'URL un ensemble de m&eacute;thodes
est propos&eacute; : 
</P>
<UL>
	<LI><P STYLE="margin-bottom: 0.00cm"><TT><FONT COLOR="#330000">public
	String getProtocol()</FONT></TT>: retourne le protocole ; 
	</P>
	<LI><P STYLE="margin-bottom: 0.00cm"><FONT COLOR="#330000"><TT>public
	String getHost()</TT> </FONT>: retourne le nom de la machine ; 
	</P>
	<LI><P STYLE="margin-bottom: 0.00cm"><TT><FONT COLOR="#330000">public
	int getPort()</FONT></TT> : retourne le num&eacute;ro de port ; 
	</P>
	<LI><P STYLE="margin-bottom: 0.00cm"><TT><FONT COLOR="#330000">public
	String getFile()</FONT></TT> : retourne la partie fichier ; 
	</P>
	<LI><P STYLE="margin-bottom: 0.00cm"><TT><FONT COLOR="#330000">public
	String getRef()</FONT></TT> : retourne la r&eacute;f&eacute;rence ou
	ancre dans le fichier (&quot;<TT><FONT COLOR="#660000">#ref</FONT></TT>&quot;)
	; 
	</P>
	<LI><P><TT><FONT COLOR="#330000">public String toExternalForm()</FONT></TT>
	: retourne la forme canonique de l'URL. 
	</P>
</UL>
<P>Une fois l'objet <TT>URL</TT> construit, pour acc&eacute;der aux
informations contenues dans l'URL, il faut construire un objet
<TT>URLConnection</TT> en utilisant la m&eacute;thode : 
</P>
<P><TT><FONT COLOR="#330000">public URLConnection openConnection()
throws IOException</FONT></TT> 
</P>
<P>Cette m&eacute;thode cr&eacute;e (si elle n'existe pas d&eacute;j&agrave;)
un objet permettant de cr&eacute;er une connexion vers la ressource
r&eacute;f&eacute;r&eacute;e par l'URL. Cette m&eacute;thode invoque
le bon gestionnaire de protocole (HTTP par exemple). 
</P>
<P>Exemple : 
</P>
<P><TT><FONT COLOR="#330000">URLConnection connexion =
url1.openConnection() ;</FONT></TT> 
</P>
<P>Il est possible, si l'on ne d&eacute;sire pas d'information sur
l'objet contenu de le r&eacute;cup&eacute;rer directement avec la
m&eacute;thode de la classe <TT><FONT COLOR="#660000">URL</FONT></TT>
: <BR><TT><FONT COLOR="#330000">public final Object getContent ()
throws IOException</FONT></TT> <BR>qui est un raccourci pour :
<BR><TT><FONT COLOR="#660000">openConnection().getContent()</FONT></TT>

</P>
<P>Exemple : 
</P>
<PRE><FONT COLOR="#330000">public class Url {</FONT>
<FONT COLOR="#330000">public static void main(String[] argv){</FONT>
<FONT COLOR="#330000"> try{</FONT>
<FONT COLOR="#330000"> URL url = new URL(&quot;http://massena.univ-mlv.fr/~roussel);</FONT>
<FONT COLOR="#330000"> String Object texte = (String) url.getContent();</FONT>
<FONT COLOR="#330000"> System.out.println(texte);</FONT>
<FONT COLOR="#330000"> }</FONT>
<FONT COLOR="#330000"> catch(MalformedURLException e){</FONT>
<FONT COLOR="#330000"> System.out.println(e);</FONT>
<FONT COLOR="#330000"> }</FONT>
<FONT COLOR="#330000"> catch(IOException e){</FONT>
<FONT COLOR="#330000"> System.out.println(e);</FONT>
<FONT COLOR="#330000"> }</FONT>
<FONT COLOR="#330000"> }</FONT>
<FONT COLOR="#330000">}</FONT></PRE>
<HR>
<H2><FONT COLOR="#3333ff">La Classe <TT>URLConnection</TT></FONT></H2>
<P><TT><FONT COLOR="#660000">URLConnection</FONT></TT> est une classe
abstraite qui propose une interface simple pour manipuler les ent&ecirc;tes
et le contenu d'une URL, d'une fa&ccedil;on ind&eacute;pendante du
protocole. Un objet de cette classe est construit par l'appel &agrave;
la m&eacute;thode <TT><FONT COLOR="#330000">openConnection()</FONT></TT>
sur un objet de la classe <TT><FONT COLOR="#330000">URL</FONT></TT>. 
</P>
<P>La premi&egrave;re chose &agrave; faire consiste &agrave;
sp&eacute;cifier les ent&ecirc;tes de requ&ecirc;tes au moyen de la
m&eacute;thode suivante : <BR><TT><FONT COLOR="#330000">public void
setRequestProperty(String key, String value)</FONT></TT> <BR>D'autres
m&eacute;thodes raccourcis sont disponibles : <BR><TT><FONT COLOR="#330000">public
long getIfModifiedSince()</FONT></TT> ... 
</P>
<P>Il faut ensuite ouvrir la connexion : <BR><TT><FONT COLOR="#330000">public
abstract void connect() throws IOException</FONT></TT> 
</P>
<P>Il est alors possible de r&eacute;cup&eacute;rer chacune des
ent&ecirc;tes par une des m&eacute;thodes suivantes : 
</P>
<UL>
	<LI><P STYLE="margin-bottom: 0.00cm"><TT><FONT COLOR="#330000">public
	String getHeaderField(String name)</FONT></TT> : retourne l'ent&ecirc;te
	dont le nom est pass&eacute; en param&egrave;tre si elle est
	pr&eacute;sente et <TT><FONT COLOR="#330000">null</FONT></TT> sinon.
	
	</P>
	<LI><P STYLE="margin-bottom: 0.00cm"><TT><FONT COLOR="#330000">public
	int getHeaderFieldInt(String name, int default)</FONT></TT> 
	</P>
	<LI><P STYLE="margin-bottom: 0.00cm"><TT><FONT COLOR="#330000">public
	long getHeaderFieldDate(String name,long default)</FONT></TT> 
	</P>
	<LI><P STYLE="margin-bottom: 0.00cm"><TT><FONT COLOR="#330000">public
	String getHeaderFieldKey(int n)</FONT></TT> 
	</P>
	<LI><P><TT><FONT COLOR="#330000">public String getHeaderField(int n)</FONT></TT>
	
	</P>
</UL>
<P>Les m&eacute;thodes suivantes sont des raccourcis pour les ent&ecirc;tes
les plus courantes : 
</P>
<UL>
	<LI><P STYLE="margin-bottom: 0.00cm"><TT><FONT COLOR="#330000">public
	int getContentLength ()</FONT></TT> 
	</P>
	<LI><P STYLE="margin-bottom: 0.00cm"><TT><FONT COLOR="#330000">public
	String getContentType ()</FONT></TT> 
	</P>
	<LI><P><TT><FONT COLOR="#330000">public long getDate ()</FONT></TT> 
	</P>
</UL>
<P>Pour r&eacute;cup&eacute;rer le contenu du document il suffit
d'utiliser la m&eacute;thode : <BR><TT><FONT COLOR="#330000">public
Object getContent() throws IOException</FONT></TT> 
</P>
<P>D'autres int&eacute;raction de plus bas niveau sont &eacute;galement
possible en r&eacute;cup&eacute;rant les flux d'entr&eacute;e et de
sortie sur la connexion. <BR><TT><FONT COLOR="#330000">public
InputStream getInputStream() throws IOException</FONT></TT> <BR><TT><FONT COLOR="#330000">public
OutputStream getOutputStream() throws IOException</FONT></TT> <BR><BR><BR>
</P>
<P>Exemple : 
</P>
<PRE><FONT COLOR="#330000">int len = connexion.getContentLength();</FONT>
<FONT COLOR="#330000">InputStream input = connexion.getInputStream();</FONT>
<FONT COLOR="#330000">for(;len != 0; len--)</FONT>
<FONT COLOR="#330000"> System.out((char)input.read());</FONT>
<FONT COLOR="#330000">....</FONT></PRE>
<HR>
<H2><A HREF="http://monge.univ-mlv.fr/~roussel/RESEAUJAVA/java.url2.html">&Eacute;crire
ses gestionnaires de protocole ou de contenu</A></H2>
</BODY>
</HTML>
